# auto-video-ingest
Bash scripts (with udev rules) to automatically ingest video files to a target directory/server.

# Setup

1. Clone the repository to a local folder. In this example /home/user/dev/auto-video-ingest
2. Create udev rules in /etc/udev/rules.d/99-auto-video-ingest.rules
   ```
   KERNEL=="mmcblk0p[0-9]", ACTION=="add", SUBSYSTEM=="block", RUN+="/bin/bash /home/user/dev/auto-video-ingestscripts/scripts/auto-video-ingest-hook $kernel"
   KERNEL=="sd*[0-9]", ACTION=="add", SUBSYSTEM=="block", RUN+="/bin/bash /home/user/dev/auto-video-ingest/scripts/auto-video-ingest-hook $kernel"
   ```
3. Add the auto-video-ingest-watchdog to your gnome startup applications
4. Create configuration in scripts/auto-video-ingest.cfg (based on auto-video-ingest.cfg.example)
5. Create a auto-video-ingest.cfg file on all drives you with to auto ingest with the following content (example!):
   ```
   NAME="Fatshark HDO"     # how should the target folder be named (i.e. camera name)
   SRCDIR="DCIM/100DSCIM"  # where do the files you wish to copy reside (i.e. DCIM)
   SUBFOLDER="RC"          # in which subfolder should the files be copied (i.e. RC)
   ```

# Components and how it works

## Udev rules
... trigger the auto-video-ingest-hook script. They obvously run as root.

## scripts/auto-video-ingest-hook
This scripts writes the detected device into a trigger file for the watchdog. Those files are crated in a way that a normal user can read and remove them.

## scripts/auto-video-ingest-watchdog
This script watches for trigger files generated by auto-video-ingest-hook and calls the worker script auto-video-ingest

## scripts/auto-video-ingest
This script is the main "brain" which copies the files from your disk to the target. This runs as the intended user.
